<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Spotify_Stats</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@400;500;600;700;800;900&family=Montserrat:wght@400;500;600;700&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: "#1DB954", // Spotify Green
                        "primary-hover": "#1aa34a",
                        "background-light": "#F3F4F6", // Gray 100
                        "card-light": "#FFFFFF",
                        "text-light": "#1F2937", // Gray 800
                        "subtext-light": "#6B7280", // Gray 500
                    },
                    fontFamily: {
                        display: ["Poppins", "sans-serif"],
                        sans: ["Inter", "sans-serif"],
                        accent: ["Montserrat", "sans-serif"],
                    },
                    borderRadius: {
                        DEFAULT: "0.5rem",
                        'xl': '1rem',
                        '2xl': '1.5rem',
                        'full': '9999px',
                    },
                    boxShadow: {
                        'soft': '0 4px 20px -2px rgba(0, 0, 0, 0.1)',
                        'glow': '0 0 15px rgba(29, 185, 84, 0.3)',
                    }
                },
            },
        };
    </script>
    <style>
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        body {
            min-height: max(884px, 100dvh);
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>

<body
    class="bg-background-light font-sans min-h-screen flex flex-col items-center justify-center p-4 antialiased selection:bg-primary selection:text-white transition-colors duration-300">
    <div class="fixed inset-0 bg-primary opacity-10 pointer-events-none z-0"></div>
    <div class="fixed -top-40 -right-40 w-96 h-96 bg-primary opacity-20 blur-3xl rounded-full pointer-events-none z-0">
    </div>
    <div
        class="fixed -bottom-40 -left-40 w-96 h-96 bg-primary opacity-20 blur-3xl rounded-full pointer-events-none z-0">
    </div>
    <main class="w-full max-w-md z-10 flex flex-col gap-6 relative">
        <header class="text-center mb-2">
            <div
                class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary mb-4 shadow-glow transform hover:scale-105 transition-transform duration-300">
                <span class="material-icons text-white text-4xl">graphic_eq</span>
            </div>
            <h1 class="text-3xl font-bold text-text-light tracking-tight font-display">Spotify_Stats</h1>
            <p class="text-subtext-light mt-1 text-sm font-sans">Analyze your listening habits</p>
        </header>

        <section
            class="bg-card-light rounded-2xl shadow-soft p-6 sm:p-8 backdrop-blur-sm bg-opacity-95 border border-gray-100 transition-all duration-300">
            <h2 class="text-xl font-bold text-center text-text-light mb-6 font-display">Choose an option</h2>
            <div class="grid grid-cols-1 gap-4">
                <div class="grid grid-cols-2 gap-4">
                    <a href="{% url 'curr_play' %}"
                        class="group flex flex-col items-center justify-center p-4 rounded-xl border border-primary text-primary hover:bg-primary hover:text-white transition-all duration-300 active:scale-95 bg-transparent">
                        <span
                            class="material-icons mb-2 text-2xl group-hover:scale-110 transition-transform">play_circle_filled</span>
                        <span class="text-xs font-bold uppercase tracking-wide text-center">Currently Playing</span>
                    </a>
                    <a href="{% url 'user_playlist' %}"
                        class="group flex flex-col items-center justify-center p-4 rounded-xl border border-primary text-primary hover:bg-primary hover:text-white transition-all duration-300 active:scale-95 bg-transparent">
                        <span
                            class="material-icons mb-2 text-2xl group-hover:scale-110 transition-transform">queue_music</span>
                        <span class="text-xs font-bold uppercase tracking-wide text-center">Playlist Info</span>
                    </a>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <a href="{% url 'top_artists' %}"
                        class="group flex flex-col items-center justify-center p-4 rounded-xl border border-primary text-primary hover:bg-primary hover:text-white transition-all duration-300 active:scale-95 bg-transparent">
                        <span
                            class="material-icons mb-2 text-2xl group-hover:scale-110 transition-transform">mic_external_on</span>
                        <span class="text-xs font-bold uppercase tracking-wide text-center">Top Artists</span>
                    </a>
                    <a href="{% url 'top_tracks' %}"
                        class="group flex flex-col items-center justify-center p-4 rounded-xl border border-primary text-primary hover:bg-primary hover:text-white transition-all duration-300 active:scale-95 bg-transparent">
                        <span
                            class="material-icons mb-2 text-2xl group-hover:scale-110 transition-transform">equalizer</span>
                        <span class="text-xs font-bold uppercase tracking-wide text-center">Top Tracks</span>
                    </a>
                </div>

                <div class="relative">
                    <button id="recentBtn"
                        class="group flex flex-row items-center justify-center p-4 rounded-xl border border-primary text-primary hover:bg-primary hover:text-white transition-all duration-300 active:scale-95 bg-transparent w-full">
                        <span
                            class="material-icons mr-2 text-2xl group-hover:scale-110 transition-transform">history</span>
                        <span id="limit-text" class="text-xs font-bold uppercase tracking-wide">Recently Played</span>
                        <span class="material-icons ml-1 text-sm">expand_more</span>
                    </button>
                    <div id="limitDropdown"
                        class="hidden absolute top-[calc(100%-138px)] left-[calc(100%+53px)]  w-48 p-4 bg-card-light border border-gray-100 rounded-xl shadow-2xl z-20">
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="setLink(5)" onmouseover="setValue(5)"
                                class="py-2 px-3 rounded-lg hover:bg-primary hover:text-white text-text-light text-sm font-bold transition-all border border-gray-100 shadow-sm">5</button>
                            <button onclick="setLink(6)" onmouseover="setValue(6)"
                                class="py-2 px-3 rounded-lg hover:bg-primary hover:text-white text-text-light text-sm font-bold transition-all border border-gray-100 shadow-sm">6</button>
                            <button onclick="setLink(7)" onmouseover="setValue(7)"
                                class="py-2 px-3 rounded-lg hover:bg-primary hover:text-white text-text-light text-sm font-bold transition-all border border-gray-100 shadow-sm">7</button>
                            <button onclick="setLink(8)" onmouseover="setValue(8)"
                                class="py-2 px-3 rounded-lg hover:bg-primary hover:text-white text-text-light text-sm font-bold transition-all border border-gray-100 shadow-sm">8</button>
                            <button onclick="setLink(9)" onmouseover="setValue(9)"
                                class="py-2 px-3 rounded-lg hover:bg-primary hover:text-white text-text-light text-sm font-bold transition-all border border-gray-100 shadow-sm">9</button>
                            <button onclick="setLink(10)" onmouseover="setValue(10)"
                                class="py-2 px-3 rounded-lg hover:bg-primary hover:text-white text-text-light text-sm font-bold transition-all border border-gray-100 shadow-sm">10</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section
            class="bg-card-light rounded-2xl shadow-soft p-6 sm:p-8 backdrop-blur-sm bg-opacity-95 border border-gray-100 transition-all duration-300">
            <div class="text-center mb-6">
                <h2 class="text-lg font-bold text-text-light font-display">Request Access!</h2>
                <p class="text-xs text-subtext-light mt-1">Request the creator for permission
                </p>
            </div>
            <form class="flex flex-col gap-4" onsubmit="event.preventDefault(); sendEmail();">
                <div class="relative group">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <span
                            class="material-icons text-gray-400 group-focus-within:text-primary transition-colors text-xl">alternate_email</span>
                    </div>
                    <input
                        class="block w-full pl-10 pr-4 py-3 border border-gray-200 rounded-full bg-gray-50 text-text-light placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all shadow-inner text-sm"
                        id="spotify-email" name="email" placeholder="Your Spotify Email" required="" type="email" />
                </div>
                <button
                    class="w-full group flex flex-row items-center justify-center p-4 rounded-full border-2 border-primary text-primary hover:bg-primary hover:text-white transition-all duration-300 active:scale-95 bg-transparent font-bold uppercase tracking-widest text-xs"
                    type="submit">
                    Send Request
                    <span class="material-icons ml-2 text-sm group-hover:translate-x-1 transition-transform">send</span>
                </button>
            </form>
        </section>

    </main>

    <script>
        function setLink(limit) {
            window.location.href = `/rec_play/?limit=${limit}`;
        }

        function setValue(limit) {
            document.getElementById('limit-text').innerHTML = `Show last ${limit} songs`;
        }

        function sendEmail() {
            const email = document.getElementById('spotify-email').value;
            if (email) {
                const subject = "Spotify Dashboard Access Request";
                const body = `Please add my Spotify email to the dashboard: ${email}`;
                const gmailUrl = `https://mail.google.com/mail/?view=cm&fs=1&to=aapratimboy@gmail.com&su=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                window.open(gmailUrl, '_blank');
            } else {
                alert('Please enter your email address');
            }
        }

        // Dropdown toggle
        const recentBtn = document.getElementById('recentBtn');
        const limitDropdown = document.getElementById('limitDropdown');

        recentBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            limitDropdown.classList.toggle('hidden');
        });

        document.addEventListener('click', (e) => {
            if (!limitDropdown.contains(e.target) && e.target !== recentBtn) {
                limitDropdown.classList.add('hidden');
            }
        });
    </script>
</body>

</html>